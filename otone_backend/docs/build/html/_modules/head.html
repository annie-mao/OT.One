<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>head &mdash; OT.One 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="OT.One 1.0.0 documentation" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">OT.One 1.0.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for head</h1><div class="highlight"><pre>
<span class="kn">import</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">smoothie_ser2net</span> <span class="kn">as</span> <span class="nn">openSmoothie</span>

<span class="kn">from</span> <span class="nn">the_queue</span> <span class="kn">import</span> <span class="n">TheQueue</span>
<span class="kn">from</span> <span class="nn">file_io</span> <span class="kn">import</span> <span class="n">FileIO</span>
<span class="kn">from</span> <span class="nn">pipette</span> <span class="kn">import</span> <span class="n">Pipette</span>


<span class="n">debug</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">verbose</span> <span class="o">=</span> <span class="bp">True</span>

<div class="viewcode-block" id="Head"><a class="viewcode-back" href="../head.html#head.Head">[docs]</a><span class="k">class</span> <span class="nc">Head</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;A representation of the robot head</span>
<span class="sd">    </span>
<span class="sd">    The Head class is intended to be instantiated to a head object which</span>
<span class="sd">    aggregates the subclassed tool objects and the smoothieAPI object.</span>
<span class="sd">    It also hold a references to theQueue and publisher objects.</span>
<span class="sd">    Appropriate methods are exposed to allow access to the aggregated object&#39;s</span>
<span class="sd">    functionality.</span>

<span class="sd">    :todo:</span>
<span class="sd">    1. Figure out if :meth:`move_plunger` is redundant and refactor accordingly</span>
<span class="sd">    2. Should :obj:`theState` be updated BEFORE the actions taken from given state?</span>
<span class="sd">    3. Is :meth:`create_deck` redundant?</span>
<span class="sd">    4. Is :meth:`create_pipettes` needed?</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<span class="c">#Special Methods-----------------------</span>
    <span class="c">#def __init__(self, tools, global_handlers, theQueue):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tools</span><span class="p">,</span> <span class="n">publisher</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize Head object</span>
<span class="sd">        </span>
<span class="sd">        tools = dictionary of the tools on the head</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.__init__ called&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smoothieAPI</span> <span class="o">=</span> <span class="n">openSmoothie</span><span class="o">.</span><span class="n">Smoothie</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span><span class="n">Pipette</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">),</span><span class="s">&#39;b&#39;</span><span class="p">:</span><span class="n">Pipette</span><span class="p">(</span><span class="s">&#39;b&#39;</span><span class="p">)}</span>    <span class="c">#need to create this dict in head setup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tools</span> <span class="o">=</span> <span class="n">tools</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pubber</span> <span class="o">=</span> <span class="n">publisher</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smoothieAPI</span><span class="o">.</span><span class="n">set_raw_callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pubber</span><span class="o">.</span><span class="n">on_raw_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smoothieAPI</span><span class="o">.</span><span class="n">set_limit_hit_callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pubber</span><span class="o">.</span><span class="n">on_limit_hit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smoothieAPI</span><span class="o">.</span><span class="n">set_move_callback</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pubber</span><span class="o">.</span><span class="n">on_start</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theQueue</span> <span class="o">=</span> <span class="n">TheQueue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">publisher</span><span class="p">)</span>
        
        <span class="c">#connect with the smoothie board</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smoothieAPI</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>        

        <span class="bp">self</span><span class="o">.</span><span class="n">load_pipette_values</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;Head&quot;</span>
        
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;Head({0!r})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        
<span class="c"># the current coordinate position, as reported from &#39;smoothie.js&#39;</span>
    <span class="n">theState</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;x&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span><span class="s">&#39;y&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span><span class="s">&#39;z&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span><span class="s">&#39;a&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span><span class="s">&#39;b&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

    <span class="c"># this function fires when &#39;smoothie.js&#39; transitions between {stat:0} and {stat:1}</span>
    <span class="c">#SMOOTHIEBOARD.on_state_change = function (state) {</span>
<div class="viewcode-block" id="Head.on_state_change"><a class="viewcode-back" href="../head.html#head.Head.on_state_change">[docs]</a>    <span class="k">def</span> <span class="nf">on_state_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check the given state (from Smoothieboard) and engage :obj:`theQueue` (:class:`the_queue`) accordingly</span>

<span class="sd">        If the state is 1 or the state.delaying is 1 then :obj:`theQueue` is_busy,</span>

<span class="sd">        else if the state is 0 and the state.delaying is 0, :obj:`theQueue` is not busy, </span>
<span class="sd">        clear the currentCommand for the next one, and if not paused, tell :obj:`theQueue` </span>
<span class="sd">        to step. Then update :obj:`theState`.</span>

<span class="sd">        :todo:</span>
<span class="sd">        2. Should :obj:`theState` be updated BEFORE the actions taken from given state?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.on_state_change called&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">state</span><span class="p">[</span><span class="s">&#39;stat&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">state</span><span class="p">[</span><span class="s">&#39;delaying&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">theQueue</span><span class="o">.</span><span class="n">is_busy</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">elif</span> <span class="n">state</span><span class="p">[</span><span class="s">&#39;stat&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">state</span><span class="p">[</span><span class="s">&#39;delaying&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">theQueue</span><span class="o">.</span><span class="n">is_busy</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">theQueue</span><span class="o">.</span><span class="n">currentCommand</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theQueue</span><span class="o">.</span><span class="n">paused</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">theQueue</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    
        <span class="bp">self</span><span class="o">.</span><span class="n">theState</span> <span class="o">=</span> <span class="n">state</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span> <span class="ow">and</span> <span class="n">verbose</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\n\t</span><span class="s">Head state:</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">theState</span><span class="p">,</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>


<span class="c">#local functions---------------</span></div>
<div class="viewcode-block" id="Head.get_tool_type"><a class="viewcode-back" href="../head.html#head.Head.get_tool_type">[docs]</a>    <span class="k">def</span> <span class="nf">get_tool_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">head_tool</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the tooltype and axis from head_tool dict</span>
<span class="sd">        </span>
<span class="sd">        :returns: (tool_type, axis)</span>
<span class="sd">        :rtype: tuple</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.get_tool_info called&#39;</span><span class="p">)</span>
        <span class="n">tool_type</span> <span class="o">=</span> <span class="n">head_tool</span><span class="p">[</span><span class="s">&#39;tool&#39;</span><span class="p">]</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">head_tool</span><span class="p">[</span><span class="s">&#39;axis&#39;</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">tool_type</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
        
        
        
<span class="c">#Methods-----------------------</span></div>
<div class="viewcode-block" id="Head.configure_head"><a class="viewcode-back" href="../head.html#head.Head.configure_head">[docs]</a>    <span class="k">def</span> <span class="nf">configure_head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">head_data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Configure the head per Head section of protocol.json file</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        :example head_data:</span>

<span class="sd">        head_data = dictionary of head data (example below):</span>
<span class="sd">            &quot;p200&quot; : {</span>
<span class="sd">                &quot;tool&quot; : &quot;pipette&quot;,</span>
<span class="sd">                &quot;tip-racks&quot; : [{&quot;container&quot; : &quot;p200-rack&quot;}],</span>
<span class="sd">                &quot;trash-container&quot; : {&quot;container&quot; : &quot;trash&quot;},</span>
<span class="sd">                &quot;tip-depth&quot; : 5,</span>
<span class="sd">                &quot;tip-height&quot; : 45,</span>
<span class="sd">                &quot;tip-total&quot; : 8,</span>
<span class="sd">                &quot;axis&quot; : &quot;a&quot;,</span>
<span class="sd">                &quot;volume&quot; : 160</span>
<span class="sd">            },</span>
<span class="sd">            &quot;p1000&quot; : {</span>
<span class="sd">                &quot;tool&quot; : &quot;pipette&quot;,</span>
<span class="sd">                &quot;tip-racks&quot; : [{&quot;container&quot; : &quot;p1000-rack&quot;}],</span>
<span class="sd">                &quot;trash-container&quot; : {&quot;container&quot; : &quot;trash&quot;},</span>
<span class="sd">                &quot;tip-depth&quot; : 7,</span>
<span class="sd">                &quot;tip-height&quot; : 65,</span>
<span class="sd">                &quot;tip-total&quot; : 8,</span>
<span class="sd">                &quot;axis&quot; : &quot;b&quot;,</span>
<span class="sd">                &quot;volume&quot; : 800</span>
<span class="sd">            }</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> 
            <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.configure_head called&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">args: &#39;</span><span class="p">,</span><span class="n">head_data</span><span class="p">,</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="c">#delete any previous tools in head</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">tools</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tools</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c">#instantiate a new tool for each name and tool type in the file</span>
        <span class="c">#ToDo - check for data validity before using</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">head_data</span><span class="p">:</span>
            <span class="n">hd</span> <span class="o">=</span> <span class="n">head_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="c">#get the tool type to know what kind of tool to instantiate</span>
            <span class="n">tool_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tool_type</span><span class="p">(</span><span class="n">hd</span><span class="p">)</span>  <span class="c">#tuple (toolType, axis)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;tool_type...&#39;</span><span class="o">+</span><span class="n">tool_type</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">tool_type</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;pipette&#39;</span><span class="p">:</span>
                <span class="c">#newtool = Pipette(hd[&#39;axis&#39;])</span>
                <span class="c">#pass</span>
                <span class="c">#self.PIPETTES[hd[&#39;axis&#39;]] = newtool</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">hd</span><span class="p">[</span><span class="s">&#39;axis&#39;</span><span class="p">]],</span><span class="s">&#39;tip_racks&#39;</span><span class="p">,</span><span class="n">hd</span><span class="p">[</span><span class="s">&#39;tip-racks&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hd</span><span class="p">[</span><span class="s">&#39;tip-racks&#39;</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">tpOD</span> <span class="o">=</span> <span class="n">hd</span><span class="p">[</span><span class="s">&#39;tip-racks&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">tpItems</span> <span class="o">=</span> <span class="n">tpOD</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="n">listTPItems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tpItems</span><span class="p">)</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">hd</span><span class="p">[</span><span class="s">&#39;axis&#39;</span><span class="p">]],</span><span class="s">&#39;tip_rack_origin&#39;</span><span class="p">,</span><span class="n">listTPItems</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>


                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">hd</span><span class="p">[</span><span class="s">&#39;axis&#39;</span><span class="p">]],</span><span class="s">&#39;trash_container&#39;</span><span class="p">,</span><span class="n">hd</span><span class="p">[</span><span class="s">&#39;trash-container&#39;</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">tool_type</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;grabber&#39;</span><span class="p">:</span>
                <span class="c">#newtool = Grabber(key,*tool_info)</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c">#ToDo - add error handling here</span>
                <span class="k">pass</span>
            
            <span class="c">#add tool to the tools list</span>
            <span class="c">#self.tools.append(newtool)</span>




        

        <span class="c">#fill the PIPETTES object with tools of the tool type &#39;pipette&#39;</span>
        <span class="c">#for tool in self.tools:</span>
        <span class="c">#    print(&#39;from line 545 in head: &#39;,tool,type(tool))</span>
        <span class="c">#    if tool.tooltype == &#39;pipette&#39;:</span>
        <span class="c">#        print(&#39;tooltype called&#39;)</span>
        <span class="c">#        axis = tool.axis</span>
        <span class="c">#        if &#39;tip-racks&#39; in tool:</span>
        <span class="c">#            self.PIPETTES[axis].calibrate(&#39;tip_racks&#39;,head_data[key][&#39;tip-racks&#39;])</span>
        <span class="c">#        self.PIPETTES[axis] = Pipette(axis)</span>
        <span class="c">#        if &#39;tip-racks&#39; in tool:</span>
        <span class="c">#            self.PIPETTES[axis].calibrate(&#39;tip_racks&#39;,head_data[&#39;tip-racks&#39;])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">save_pipette_values</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publish_calibrations</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="Head.relative_coords"><a class="viewcode-back" href="../head.html#head.Head.relative_coords">[docs]</a>    <span class="k">def</span> <span class="nf">relative_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">relative_coords</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_pipette_values</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publish_calibrations</span><span class="p">()</span>
        
    <span class="c">#this came from pipette class in js code</span></div>
<div class="viewcode-block" id="Head.create_pipettes"><a class="viewcode-back" href="../head.html#head.Head.create_pipettes">[docs]</a>    <span class="k">def</span> <span class="nf">create_pipettes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create and return a dictionary of Pipette objects</span>

<span class="sd">        :returns: A dictionary of pipette objects</span>
<span class="sd">        :rtype: dictionary</span>
<span class="sd">        </span>
<span class="sd">        :note: Seems nothing calls this...</span>

<span class="sd">        :todo:</span>
<span class="sd">        4. Is :meth:`create_pipettes` needed?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.create_pipettes called&#39;</span><span class="p">)</span>
        <span class="n">thePipettes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axis</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axis</span><span class="p">:</span>
            <span class="c">#for i in range(0,len(axis)):</span>
                <span class="c">#a = axis(i)</span>
                <span class="n">thePipettes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pipette</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                
        <span class="k">return</span> <span class="n">thePipettes</span>
        
        
    <span class="c">#Command related methods for the head object</span>
    <span class="c">#corresponding to the exposed methods in the Planner.js file</span>
    <span class="c">#from planner.js</span></div>
<div class="viewcode-block" id="Head.home"><a class="viewcode-back" href="../head.html#head.Head.home">[docs]</a>    <span class="k">def</span> <span class="nf">home</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis_dict</span><span class="p">):</span>   <span class="c">#, callback):</span>
        <span class="sd">&quot;&quot;&quot;Home robot according to axis_dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#maps to smoothieAPI.home()</span>
        <span class="c">#print(&#39;{} msg received in head, calling home on smoothie&#39;.format(axis_dict))</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.home called, args: &#39;</span><span class="p">,</span><span class="n">axis_dict</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">smoothieAPI</span><span class="o">.</span><span class="n">home</span><span class="p">(</span><span class="n">axis_dict</span><span class="p">)</span>
        
        
    <span class="c">#from planner.js</span></div>
<div class="viewcode-block" id="Head.raw"><a class="viewcode-back" href="../head.html#head.Head.raw">[docs]</a>    <span class="k">def</span> <span class="nf">raw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send a raw command to the Smoothieboard</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.raw called&#39;</span><span class="p">)</span>
        <span class="c">#maps to smoothieAPI.raw()</span>
        <span class="c">#function raw(string)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smoothieAPI</span><span class="o">.</span><span class="n">raw</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        
        
    <span class="c">#from planner.js</span></div>
<div class="viewcode-block" id="Head.kill"><a class="viewcode-back" href="../head.html#head.Head.kill">[docs]</a>    <span class="k">def</span> <span class="nf">kill</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Halt the Smoothieboard (M112) and clear the the object (:class:`the_queue`)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.kill called&#39;</span><span class="p">)</span>
        <span class="c">#maps to smoothieAPI.halt() with extra code</span>
<span class="c">#        print(&#39;{} msg received in head, calling halt on smoothie&#39;.format(data))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smoothieAPI</span><span class="o">.</span><span class="n">halt</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theQueue</span><span class="o">.</span><span class="n">clear</span><span class="p">();</span>

    <span class="c">#from planner.js</span></div>
<div class="viewcode-block" id="Head.reset"><a class="viewcode-back" href="../head.html#head.Head.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reset the Smoothieboard and clear theQueue object (:class:`the_queue`)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.reset called&#39;</span><span class="p">)</span>
        <span class="c">#maps to smoothieAPI.reset() with extra code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smoothieAPI</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theQueue</span><span class="o">.</span><span class="n">clear</span><span class="p">();</span>
        
        
    <span class="c">#from planner.js</span></div>
<div class="viewcode-block" id="Head.get_state"><a class="viewcode-back" href="../head.html#head.Head.get_state">[docs]</a>    <span class="k">def</span> <span class="nf">get_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get state information from Smoothieboard</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.get_state called&#39;</span><span class="p">)</span>
        <span class="c">#maps to smoothieAPI.get_state()</span>
        <span class="c">#function get_state ()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">smoothieAPI</span><span class="o">.</span><span class="n">get_state</span><span class="p">()</span>
        
        
        <span class="c">#from planner.js</span></div>
<div class="viewcode-block" id="Head.set_speed"><a class="viewcode-back" href="../head.html#head.Head.set_speed">[docs]</a>    <span class="k">def</span> <span class="nf">set_speed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the speed for given axis to given value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.set_speed called&#39;</span><span class="p">)</span>
        
        <span class="c">#maps to smoothieAPI.set_speed()</span>
        <span class="c">#function setSpeed(axis, value, callback)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smoothieAPI</span><span class="o">.</span><span class="n">set_speed</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        
        
        <span class="c">#from planner.js</span>
        <span class="c">#function move (locations)</span>
        <span class="c">#doesn&#39;t map to smoothieAPI</span></div>
<div class="viewcode-block" id="Head.move"><a class="viewcode-back" href="../head.html#head.Head.move">[docs]</a>    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locations</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Moves the head by adding locations to theQueue</span>



<span class="sd">        var locations = [location,location,...]</span>

<span class="sd">        var location = {</span>
<span class="sd">        &#39;relative&#39; : true || false || undefined (defaults to absolute)</span>
<span class="sd">        &#39;x&#39; : 30,</span>
<span class="sd">        &#39;y&#39; : 20,</span>
<span class="sd">        &#39;z&#39; : 10,</span>
<span class="sd">        &#39;a&#39; : 20,</span>
<span class="sd">        &#39;b&#39; : 32</span>
<span class="sd">        }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.move called&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">locations</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span> <span class="ow">and</span> <span class="n">verbose</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;locations:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span><span class="n">locations</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">theQueue</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">locations</span><span class="p">)</span>
        
    <span class="c">#from planner.js</span>
    <span class="c">#function step (locations)</span>
    <span class="c">#doesn&#39;t map to smoothieAPI</span></div>
<div class="viewcode-block" id="Head.step"><a class="viewcode-back" href="../head.html#head.Head.step">[docs]</a>    <span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locations</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Step to the next command in theQueue(:class:`the_queue`) object&#39;s qlist</span>

<span class="sd">        </span>
<span class="sd">        locations = [location,location,...]</span>

<span class="sd">        location = {</span>
<span class="sd">        &#39;x&#39; : 30,</span>
<span class="sd">        &#39;y&#39; : 20,</span>
<span class="sd">        &#39;z&#39; : 10,</span>
<span class="sd">        &#39;a&#39; : 20,</span>
<span class="sd">        &#39;b&#39; : 32</span>
<span class="sd">        }</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.step called&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> 
                <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">locations:</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">,</span><span class="n">locations</span><span class="p">,</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                <span class="c"># only step with the UI if the queue is currently empty</span>
                <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head:</span><span class="se">\n\t</span><span class="s">len(self.theQueue.qlist): &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theQueue</span><span class="o">.</span><span class="n">qlist</span><span class="p">),</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head:</span><span class="se">\n\t</span><span class="s">self.theQueue.is_busy?: &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">theQueue</span><span class="o">.</span><span class="n">is_busy</span><span class="p">,</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theQueue</span><span class="o">.</span><span class="n">qlist</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="c"># and self.theQueue.is_busy==False:</span>

            <span class="k">if</span> <span class="n">locations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">locations</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
<span class="c">#                    for( i = 0; i &lt; locations.length; i++):</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">locations</span><span class="p">)):</span>
                        <span class="n">locations</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&#39;relative&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="bp">True</span>
                        
                <span class="k">elif</span> <span class="p">(</span><span class="s">&#39;x&#39;</span> <span class="ow">in</span> <span class="n">locations</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s">&#39;y&#39;</span> <span class="ow">in</span> <span class="n">locations</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s">&#39;z&#39;</span> <span class="ow">in</span> <span class="n">locations</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s">&#39;a&#39;</span> <span class="ow">in</span> <span class="n">locations</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s">&#39;b&#39;</span> <span class="ow">in</span> <span class="n">locations</span><span class="p">):</span>
                    <span class="n">locations</span><span class="p">[</span><span class="s">&#39;relative&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="bp">True</span>
                    
                <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">locations</span><span class="p">)</span>
         
         
    <span class="c">#from planner.js</span>
    <span class="c">#function pipette(group)</span></div>
<div class="viewcode-block" id="Head.pipette"><a class="viewcode-back" href="../head.html#head.Head.pipette">[docs]</a>    <span class="k">def</span> <span class="nf">pipette</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Run a pipette operation based on a given Group from protocol instructions</span>


<span class="sd">        group = {</span>
<span class="sd">          command : &#39;pipette&#39;,</span>
<span class="sd">          axis : &#39;a&#39; || &#39;b&#39;,</span>
<span class="sd">          locations : [location, location, ...]</span>
<span class="sd">        }</span>
<span class="sd">    </span>
<span class="sd">        location = {</span>
<span class="sd">          x : number,</span>
<span class="sd">          y : number,</span>
<span class="sd">          z : number,</span>
<span class="sd">          container : string,</span>
<span class="sd">          plunger : float || &#39;blowout&#39; || &#39;droptip&#39;</span>
<span class="sd">        }</span>
<span class="sd">    </span>
<span class="sd">        If no container is specified, XYZ coordinates are absolute to the Smoothieboard</span>
<span class="sd">        if a container is specified, XYZ coordinates are relative to the container&#39;s origin </span>
<span class="sd">        (180 degree rotation around X axis, ie Z and Y +/- flipped)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.pipette called&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">group</span> <span class="ow">and</span> <span class="s">&#39;axis&#39;</span> <span class="ow">in</span> <span class="n">group</span> <span class="ow">and</span> <span class="n">group</span><span class="p">[</span><span class="s">&#39;axis&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span> <span class="ow">and</span> <span class="s">&#39;locations&#39;</span> <span class="ow">in</span> <span class="n">group</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="s">&#39;locations&#39;</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
    
            <span class="n">this_axis</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="s">&#39;axis&#39;</span><span class="p">]</span>  
            <span class="n">current_pipette</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">this_axis</span><span class="p">]</span>  
    
            <span class="c"># the array of move commands we are about to build from each location</span>
            <span class="c"># starting with this pipette&#39;s initializing move commands</span>
            <span class="n">move_commands</span> <span class="o">=</span> <span class="n">current_pipette</span><span class="o">.</span><span class="n">init_sequence</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span> <span class="ow">and</span> <span class="n">verbose</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">head.pipette</span><span class="se">\n\t</span><span class="s">current_pipette.init_sequence():</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">,</span><span class="n">current_pipette</span><span class="o">.</span><span class="n">init_sequence</span><span class="p">(),</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">head.pipette</span><span class="se">\n\t</span><span class="s">move_commands:</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">,</span><span class="n">move_commands</span><span class="p">,</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    
            <span class="c"># loop through each location</span>
            <span class="c"># using each pipette&#39;s calibrations to test and convert to absolute coordinates</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="s">&#39;locations&#39;</span><span class="p">]))</span> <span class="p">:</span>
    
                <span class="n">thisLocation</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="s">&#39;locations&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>  
    
                <span class="c"># convert to absolute coordinates for the specifed pipette axis</span>
                <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.pipette:</span><span class="se">\n\t</span><span class="s">location: &#39;</span><span class="p">,</span><span class="n">thisLocation</span><span class="p">,</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                <span class="n">absCoords</span> <span class="o">=</span> <span class="n">current_pipette</span><span class="o">.</span><span class="n">pmap</span><span class="p">(</span><span class="n">thisLocation</span><span class="p">)</span>  
    
                <span class="c"># add the absolute coordinates we just made to our final array</span>
                <span class="n">move_commands</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">absCoords</span><span class="p">)</span>  
    
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">move_commands</span><span class="p">):</span>
                <span class="n">move_commands</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">current_pipette</span><span class="o">.</span><span class="n">end_sequence</span><span class="p">())</span>  
                <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">move_commands</span><span class="p">)</span>  
      
    
    <span class="c">#from planner.js</span></div>
<div class="viewcode-block" id="Head.calibrate_pipette"><a class="viewcode-back" href="../head.html#head.Head.calibrate_pipette">[docs]</a>    <span class="k">def</span> <span class="nf">calibrate_pipette</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pipette</span><span class="p">,</span> <span class="n">property_</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the value of a property for given pipette by fetching state information </span>
<span class="sd">        from smoothieboard(:meth:`smoothie_ser2net.get_state`)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.calibrate_pipette called&#39;</span><span class="p">)</span>
        <span class="c">#maps to smoothieAPI.get_state() with extra code</span>
        <span class="k">if</span> <span class="n">pipette</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">pipette</span><span class="p">]:</span> 
            <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smoothieAPI</span><span class="o">.</span><span class="n">get_state</span><span class="p">()</span>
            <span class="c"># firststop, bottom to delete</span>
            <span class="k">if</span> <span class="n">property_</span><span class="o">==</span><span class="s">&#39;top&#39;</span> <span class="ow">or</span> <span class="n">property_</span><span class="o">==</span><span class="s">&#39;blowout&#39;</span> <span class="ow">or</span> <span class="n">property_</span><span class="o">==</span><span class="s">&#39;droptip&#39;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">pipette</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">pipette</span><span class="p">]</span><span class="o">.</span><span class="n">calibrate</span><span class="p">(</span><span class="n">property_</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>  
                <span class="bp">self</span><span class="o">.</span><span class="n">save_pipette_values</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="Head.calibrate_container"><a class="viewcode-back" href="../head.html#head.Head.calibrate_container">[docs]</a>    <span class="k">def</span> <span class="nf">calibrate_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pipette</span><span class="p">,</span> <span class="n">container</span><span class="p">):</span>   
        <span class="sd">&quot;&quot;&quot;Set the location of a container</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.calibrate_container called&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pipette</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">pipette</span><span class="p">]:</span>     
            <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smoothieAPI</span><span class="o">.</span><span class="n">get_state</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">pipette</span><span class="p">]</span><span class="o">.</span><span class="n">calibrate_container</span><span class="p">(</span><span class="n">container</span><span class="p">,</span><span class="n">state</span><span class="p">)</span>

             </div>
<div class="viewcode-block" id="Head.save_volume"><a class="viewcode-back" href="../head.html#head.Head.save_volume">[docs]</a>    <span class="k">def</span> <span class="nf">save_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save pipette volume to data/pipette_values.json</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.save_volume called&#39;</span><span class="p">)</span>
        <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">axis</span><span class="p">]</span> <span class="ow">and</span> <span class="n">data</span><span class="o">.</span><span class="n">volume</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">data</span><span class="o">.</span><span class="n">volume</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">volume</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">save_pipette_values</span><span class="p">()</span>
        
        
    <span class="c">#from planner.js</span></div>
<div class="viewcode-block" id="Head.save_pipette_values"><a class="viewcode-back" href="../head.html#head.Head.save_pipette_values">[docs]</a>    <span class="k">def</span> <span class="nf">save_pipette_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save pipette values to data/pipette_values.json</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.save_pipette_values called&#39;</span><span class="p">)</span>
        <span class="n">pipette_values</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">:</span>
            <span class="n">pipette_values</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">pipette_values</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

            <span class="c"># should include:</span>
            <span class="c">#  &#39;top&#39;</span>
            <span class="c">#  &#39;bottom&#39;</span>
            <span class="c">#  &#39;blowout&#39;</span>
            <span class="c">#  &#39;droptip&#39;</span>
            <span class="c">#  &#39;volume&#39;</span>
            <span class="c">#  &#39;theContainers&#39;</span>

        <span class="n">filetext</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">pipette_values</span><span class="p">,</span><span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">,</span><span class="s">&#39;: &#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;filetext: &#39;</span><span class="p">,</span> <span class="n">filetext</span><span class="p">)</span>
        
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_path</span><span class="p">,</span><span class="s">&#39;data/pipette_calibrations.json&#39;</span><span class="p">)</span>

        <span class="c"># save the pipette&#39;s values to a local file, to be loaded when the server restarts</span>
        <span class="n">FileIO</span><span class="o">.</span><span class="n">writeFile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">filetext</span><span class="p">,</span><span class="k">lambda</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">onError</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\t\t</span><span class="s">Error saving the file:</span><span class="se">\r\r</span><span class="s">&#39;</span><span class="p">))</span>      


    <span class="c">#from planner.js</span>
    <span class="c">#fs.readFile(&#39;./data/pipette_calibrations.json&#39;, &#39;utf8&#39;, function (err,data)</span>
    <span class="c">#load_pipette_values()</span></div>
<div class="viewcode-block" id="Head.load_pipette_values"><a class="viewcode-back" href="../head.html#head.Head.load_pipette_values">[docs]</a>    <span class="k">def</span> <span class="nf">load_pipette_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load pipette values from data/pipette_calibrations.json</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.load_pipette_values called&#39;</span><span class="p">)</span>
        <span class="n">old_values</span> <span class="o">=</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">get_dict_from_json</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_path</span><span class="p">,</span><span class="s">&#39;data/pipette_calibrations.json&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;old_values:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span><span class="n">old_values</span><span class="p">,</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="n">old_values</span><span class="p">:</span>
                <span class="c">#for n in old_values[axis]:</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">old_values</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

                    <span class="c"># should include:</span>
                    <span class="c">#  &#39;resting&#39;</span>
                    <span class="c">#  &#39;top&#39;</span>
                    <span class="c">#  &#39;bottom&#39;</span>
                    <span class="c">#  &#39;blowout&#39;</span>
                    <span class="c">#  &#39;droptip&#39;</span>
                    <span class="c">#  &#39;volume&#39;</span>
                    <span class="c">#  &#39;theContainers&#39;</span>
            
            <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;self.PIPETTES[&#39;</span><span class="p">,</span><span class="n">axis</span><span class="p">,</span><span class="s">&#39;]:</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">axis</span><span class="p">],</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.load_pipette_values: No pipettes defined in PIPETTES&#39;</span><span class="p">)</span>
            
    <span class="c">#from planner.js</span>
    <span class="c"># an array of new container names to be stored in each pipette</span>
    <span class="c">#ToDo: this method may be redundant</span></div>
<div class="viewcode-block" id="Head.create_deck"><a class="viewcode-back" href="../head.html#head.Head.create_deck">[docs]</a>    <span class="k">def</span> <span class="nf">create_deck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_deck</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a dictionary of new container names to be stored in each pipette given a deck list</span>

<span class="sd">        Calls :meth:`head.save_pipette_values` right before returning dictionary</span>

<span class="sd">        :returns: container data for each axis</span>
<span class="sd">        :rtype: dictionary</span>
<span class="sd">        </span>
<span class="sd">        :todo:</span>
<span class="sd">        3. Is :meth:`create_deck` redundant?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> 
            <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.create_deck called&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">newDeck:</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">new_deck</span><span class="p">,</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        
        <span class="c">#doesn&#39;t map to smoothieAPI</span>
        <span class="n">nameArray</span> <span class="o">=</span> <span class="p">[]</span>  

        <span class="k">for</span> <span class="n">containerName</span> <span class="ow">in</span> <span class="n">new_deck</span> <span class="p">:</span>
            <span class="n">nameArray</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">containerName</span><span class="p">)</span> 
        
        <span class="n">response</span> <span class="o">=</span> <span class="p">{}</span>  
        
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">:</span>
            <span class="n">response</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">create_deck</span><span class="p">(</span><span class="n">nameArray</span><span class="p">)</span>  

        <span class="bp">self</span><span class="o">.</span><span class="n">save_pipette_values</span><span class="p">()</span> 
        <span class="k">return</span> <span class="n">response</span>         
            
            </div>
<div class="viewcode-block" id="Head.get_deck"><a class="viewcode-back" href="../head.html#head.Head.get_deck">[docs]</a>    <span class="k">def</span> <span class="nf">get_deck</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a dictionary of container names currently stored in each pipette</span>

<span class="sd">        Calls :meth:`head.save_pipette_values` right before returning dictionary</span>

<span class="sd">        :returns: container data for each axis</span>
<span class="sd">        :rtype: dictionary</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.get_deck called&#39;</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">:</span>
            <span class="n">response</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;self.PIPETTES[&#39;</span><span class="p">,</span><span class="n">axis</span><span class="p">,</span><span class="s">&#39;].theContainers:</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">theContainers</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">theContainers</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;self.PIPETTES[&#39;</span><span class="p">,</span><span class="n">axis</span><span class="p">,</span><span class="s">&#39;].theContainers[&#39;</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="s">&#39;]:</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">theContainers</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
                <span class="n">response</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">theContainers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
  
        <span class="bp">self</span><span class="o">.</span><span class="n">save_pipette_values</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.get_deck response:</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">,</span><span class="n">response</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span>

</div>
<div class="viewcode-block" id="Head.get_pipettes"><a class="viewcode-back" href="../head.html#head.Head.get_pipettes">[docs]</a>    <span class="k">def</span> <span class="nf">get_pipettes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a dictionary of pipette properties for each pipette on head</span>

<span class="sd">        :returns: Pipette properties for each pipette</span>
<span class="sd">        :rtype: dictionary</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.get_pipettes called&#39;</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">:</span>
            <span class="n">response</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">response</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
            
            <span class="c"># should include:</span>
            <span class="c">#  &#39;top&#39;</span>
            <span class="c">#  &#39;bottom&#39;</span>
            <span class="c">#  &#39;blowout&#39;</span>
            <span class="c">#  &#39;droptip&#39;</span>
            <span class="c">#  &#39;volume&#39;</span>
        
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.get_pipettes response:</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">,</span><span class="n">response</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">response</span>

    <span class="c">#from planner.js</span></div>
<div class="viewcode-block" id="Head.move_pipette"><a class="viewcode-back" href="../head.html#head.Head.move_pipette">[docs]</a>    <span class="k">def</span> <span class="nf">move_pipette</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">property_</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Move the pipette to one of it&#39;s calibrated positions (top, bottom, blowout, droptip)</span>
<span class="sd">        </span>
<span class="sd">        This command is useful for seeing saved pipette positions while calibrating</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#doesn&#39;t map to smoothieAPI</span>
        <span class="c">#function movePipette (axis, property)</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> 
            <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.move_pipette called&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\t</span><span class="s">axis: &#39;</span><span class="p">,</span><span class="n">axis</span><span class="p">,</span><span class="s">&#39;</span><span class="se">\n\t</span><span class="s">property_: &#39;</span><span class="p">,</span><span class="n">property_</span><span class="p">,</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
                <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head:</span><span class="se">\n\t</span><span class="s">self.PIPETTES[axis].__dict__[&#39;</span><span class="p">,</span><span class="n">property_</span><span class="p">,</span><span class="s">&#39;] = &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">property_</span><span class="p">],</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="ow">and</span> <span class="n">property_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>
            <span class="n">moveCommand</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">moveCommand</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">property_</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span> <span class="ow">and</span> <span class="n">verbose</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">moveCommand = &#39;</span><span class="p">,</span><span class="n">moveCommand</span><span class="p">)</span>
                <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">moveCommand</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">moveCommand</span><span class="p">)</span>
            
    
    </div>
<div class="viewcode-block" id="Head.move_plunger"><a class="viewcode-back" href="../head.html#head.Head.move_plunger">[docs]</a>    <span class="k">def</span> <span class="nf">move_plunger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">locations</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Move the plunger for given axis according to locations</span>

<span class="sd">        :note: This is only called from :class:`subscriber` and may be redundant</span>

<span class="sd">        locations = [loc, loc, etc... ]</span>

<span class="sd">        loc = {&#39;plunger&#39; : number}</span>

<span class="sd">        :todo:</span>
<span class="sd">        1. Figure out if :meth:`move_plunger` is redundant and refactor accordingly</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.move_plunger called&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n\t</span><span class="s">locations:</span><span class="se">\n\n</span><span class="s">&#39;</span><span class="p">,</span><span class="n">locations</span><span class="p">,</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">axis</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">locations</span><span class="p">)):</span>
                <span class="n">moveCommand</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PIPETTES</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span><span class="o">.</span><span class="n">pmap</span><span class="p">(</span><span class="n">locations</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">moveCommand</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Head.erase_job"><a class="viewcode-back" href="../head.html#head.Head.erase_job">[docs]</a>    <span class="k">def</span> <span class="nf">erase_job</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Tell theQueue to clear</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.erase_job called&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theQueue</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="Head.publish_calibrations"><a class="viewcode-back" href="../head.html#head.Head.publish_calibrations">[docs]</a>    <span class="k">def</span> <span class="nf">publish_calibrations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Publish calibrations data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="n">FileIO</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;head.publish_calibrations called&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pubber</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="s">&#39;containerLocations&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">get_deck</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pubber</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="s">&#39;pipetteValues&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">get_pipettes</span><span class="p">())</span>
        </div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Nick Wagner.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.4</a>
      
    </div>

    

    
  </body>
</html>